import{p as o,K as e,o as s,c as t,w as a,b as n,h as i,j as p,i as c,k as r,r as l,ae as u}from"./index.8a89d12b.js";import{_ as m}from"./uni-id-pages-sms-form.eb559907.js";import{r as d}from"./uni-app.es.42fcfc95.js";import{_ as h}from"./uni-forms.c148bd57.js";import{_ as f}from"./uni-popup-captcha.d98a8542.js";import{m as g}from"./login-page.mixin.eb2ba011.js";import{_ as b}from"./plugin-vue_export-helper.21dcd24c.js";import"./uni-captcha.cd5060ee.js";import"./uni-icons.41c57c15.js";import"./uni-easyinput.64e4af28.js";import"./uni-popup.344f4fa2.js";import"./store.e01ffa37.js";var j=b({mixins:[g],data:()=>({code:"",phone:"",captcha:"",logo:"/static/logo.png"}),computed:{tipText(){return"验证码已通过短信发送至"+this.phone}},onLoad({phoneNumber:o}){this.phone=o},onShow(){console.log("onShow"),document.onkeydown=o=>{var e=o||window.event;e&&13==e.keyCode&&this.submit()}},methods:{submit(){const s=o.importObject("uni-id-co",{errorOptions:{type:"toast"}});if(6!=this.code.length)return this.$refs.smsCode.focusSmsCodeInput=!0,e({title:"验证码不能为空",icon:"none"});s.loginBySms({mobile:this.phone,code:this.code,captcha:this.captcha}).then((o=>{console.log(o),this.loginSuccess(o)})).catch((o=>{"uni-id-captcha-required"==o.errCode?this.$refs.popup.open():(console.log(o.errMsg),console.log(o.errCode))})).finally((o=>{this.captcha=""}))}}},[["render",function(o,e,g,b,j,_){const y=p,C=c,w=r,x=d(l("uni-id-pages-sms-form"),m),V=u,k=d(l("uni-forms"),h),v=d(l("uni-popup-captcha"),f);return s(),t(C,{class:"uni-content"},{default:a((()=>[n(C,{class:"login-logo"},{default:a((()=>[n(y,{src:j.logo},null,8,["src"])])),_:1}),n(w,{class:"title"},{default:a((()=>[i("请输入验证码")])),_:1}),n(w,{class:"tip"},{default:a((()=>[i("先输入图形验证码，再获取短信验证码")])),_:1}),n(k,null,{default:a((()=>[n(x,{focusCaptchaInput:"",modelValue:j.code,"onUpdate:modelValue":e[0]||(e[0]=o=>j.code=o),type:"login-by-sms",ref:"smsCode",phone:j.phone},null,8,["modelValue","phone"]),n(V,{class:"uni-btn send-btn",type:"primary",onClick:_.submit},{default:a((()=>[i("登录")])),_:1},8,["onClick"])])),_:1}),n(v,{onConfirm:_.submit,modelValue:j.captcha,"onUpdate:modelValue":e[1]||(e[1]=o=>j.captcha=o),scene:"login-by-sms",ref:"popup"},null,8,["onConfirm","modelValue"])])),_:1})}],["__scopeId","data-v-75bf6d30"]]);export{j as default};
