var o=Object.defineProperty,s=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(s,e,a)=>e in s?o(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a,t=(o,t)=>{for(var l in t||(t={}))e.call(t,l)&&r(o,l,t[l]);if(s)for(var l of s(t))a.call(t,l)&&r(o,l,t[l]);return o};import{p as l,W as d,V as n,v as u,L as i,o as c,c as m,w as f,b as p,h as w,j as P,i as b,k as h,r as g,ae as _}from"./index.8a89d12b.js";import{_ as y}from"./uni-match-media.6fe608e4.js";import{r as j}from"./uni-app.es.42fcfc95.js";import{_ as v}from"./uni-easyinput.64e4af28.js";import{_ as x}from"./uni-forms-item.cb4a0bc6.js";import{_ as D}from"./uni-forms.c148bd57.js";import{m as O}from"./login-page.mixin.eb2ba011.js";import{p as V}from"./password.08b98a18.js";import{_ as k}from"./plugin-vue_export-helper.21dcd24c.js";import"./uni-icons.41c57c15.js";import"./store.e01ffa37.js";const B=l.importObject("uni-id-co",{customUI:!0});var N=k({mixins:[O],data:()=>({focusOldPassword:!1,focusNewPassword:!1,focusNewPassword2:!1,formData:{oldPassword:"",newPassword:"",newPassword2:""},rules:t({oldPassword:{rules:[{required:!0,errorMessage:"请输入新密码"},{pattern:/^.{6,20}$/,errorMessage:"密码为6 - 20位"}]}},V.getPwdRules("newPassword","newPassword2")),logo:"/static/logo.png"}),onReady(){this.$refs.form.setRules(this.rules)},onShow(){document.onkeydown=o=>{var s=o||window.event;s&&13==s.keyCode&&this.submit()}},methods:{submit(){console.log("formData",this.formData),console.log("rules",this.rules),this.$refs.form.validate().then((o=>{let{oldPassword:s,newPassword:e}=this.formData;B.updatePwd({oldPassword:s,newPassword:e}).then((o=>{console.log(o),d("uni_id_token"),n("uni_id_token_expired",0),u({url:"/uni_modules/uni-id-pages/pages/login/login-withpwd"})})).catch((o=>{i({content:o.message,showCancel:!1})}))})).catch((o=>{let s=o[0].key;s=s.replace(s[0],s[0].toUpperCase()),console.log(s,"focus"+s),this["focus"+s]=!0}))}}},[["render",function(o,s,e,a,r,t){const l=P,d=b,n=h,u=j(g("uni-match-media"),y),i=j(g("uni-easyinput"),v),O=j(g("uni-forms-item"),x),V=_,k=j(g("uni-forms"),D);return c(),m(d,{class:"uni-content"},{default:f((()=>[p(u,{"min-width":690},{default:f((()=>[p(d,{class:"login-logo"},{default:f((()=>[p(l,{src:r.logo},null,8,["src"])])),_:1}),p(n,{class:"title title-box"},{default:f((()=>[w("修改密码")])),_:1})])),_:1}),p(k,{ref:"form",value:r.formData,"err-show-type":"toast"},{default:f((()=>[p(O,{name:"oldPassword"},{default:f((()=>[p(i,{focus:r.focusOldPassword,onBlur:s[0]||(s[0]=o=>r.focusOldPassword=!1),class:"input-box",type:"password",inputBorder:!1,modelValue:r.formData.oldPassword,"onUpdate:modelValue":s[1]||(s[1]=o=>r.formData.oldPassword=o),placeholder:"请输入旧密码"},null,8,["focus","modelValue"])])),_:1}),p(O,{name:"newPassword"},{default:f((()=>[p(i,{focus:r.focusNewPassword,onBlur:s[2]||(s[2]=o=>r.focusNewPassword=!1),class:"input-box",type:"password",inputBorder:!1,modelValue:r.formData.newPassword,"onUpdate:modelValue":s[3]||(s[3]=o=>r.formData.newPassword=o),placeholder:"请输入新密码"},null,8,["focus","modelValue"])])),_:1}),p(O,{name:"newPassword2"},{default:f((()=>[p(i,{focus:r.focusNewPassword2,onBlur:s[4]||(s[4]=o=>r.focusNewPassword2=!1),class:"input-box",type:"password",inputBorder:!1,modelValue:r.formData.newPassword2,"onUpdate:modelValue":s[5]||(s[5]=o=>r.formData.newPassword2=o),placeholder:"请再次输入新密码"},null,8,["focus","modelValue"])])),_:1}),p(V,{class:"uni-btn send-btn-box",type:"primary",onClick:t.submit},{default:f((()=>[w("提交")])),_:1},8,["onClick"])])),_:1},8,["value"])])),_:1})}],["__scopeId","data-v-1c3cb5fc"]]);export{N as default};
