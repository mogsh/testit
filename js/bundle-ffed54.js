webpackJsonp([93],{252:function(t,e,a){"use strict";function i(t){s||a(479)}Object.defineProperty(e,"__esModule",{value:!0});var r=a(361),o=a.n(r);for(var l in r)"default"!==l&&function(t){a.d(e,t,function(){return r[t]})}(l);var n=a(481),s=!1,c=a(21),u=i,p=c(o.a,n.a,!1,u,"data-v-35512bfc",null);p.options.__file="src\\component\\admin\\goods\\EditType.vue",e.default=p.exports},361:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(92),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default={data:function(){return{popoverVisible:!1,tempChildAttr:"",typeId:"",childTypeId:"",total:0,pages:0,dialogType:0,inputVisible:!1,subTypeInput:"",dialogFormVisible:!1,dialogVisible1:!1,childTypeForm:{categoryId:"",childrenName:"",attributeNames:[]},ruleForm:{attributeCategoryName:"",childrenName:"",attributeNames:[]},rules:{},childAttr:{},rulesOfChildAttr:{},query:{pageNum:1,pageSize:20,categoryLevel:2,categoryId:""},tableData:[]}},methods:{saveChildAttr:function(){var t=this;this.dialogVisible1=!1;var e=this.childAttr,a={};a.goodsAttributeCategoryId=e.attributeCategoryId,a.attributeCategoryName=e.attributeCategoryName;var i=e.goodsAttributeDto;a.goodsAttributeArrayList=i;var o=(0,r.default)(a);this.$http.post(this.$api.updateChildrenAttributeCategory,o).then(function(e){e.data.flag?(t.$message.success("修改成功！"),t.getTypeData()):t.$message.error(e.data.msg)})},getTypeData:function(){var t=this;this.typeId=this.$route.params.id;var e=this.typeId,a=this.$route.params.name;this.query.categoryId=e,this.childTypeForm.categoryId=e,this.ruleForm.attributeCategoryName=a,this.$http.get(this.$api.findChildrenGoodsAttributeCategoryListPage,{params:this.query}).then(function(e){var a=e.data.data.list;a.forEach(function(t,e){var i="";t.goodsAttributeDto.forEach(function(t,e){i&&(i+=","),i+=t.attributeName}),a[e].childrenNames=i}),t.tableData=a,t.total=e.data.data.total})},editTypeAttr:function(t){var e=t;this.childAttr=e,this.dialogVisible1=!0},editTypeName:function(){var t=this,e={};e.categoryId=this.typeId,e.categoryName=this.ruleForm.attributeCategoryName,this.$http.get(this.$api.updateAttributeCategory,{params:e}).then(function(e){t.$message.success("修改成功！")})},addChildType:function(){this.dialogType=0,this.childTypeForm.childrenName="",this.childTypeForm.attributeNames=[],this.dialogFormVisible=!0},delChildType:function(t){var e=this,a={};a.categoryId=t.attributeCategoryId,a.isSubordinate=!0,this.$confirm("确认删除该分类？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http.get(e.$api.deleteGoodsAttributeCategory,{params:a}).then(function(t){t.data.flag?(e.$message.success("成功删除！"),e.getTypeData()):e.$message.error(t.data.msg)})}).catch(function(){e.$message.info("已取消 [删除] 操作！")})},saveChildType:function(){var t=this;if(0==this.dialogType){this.dialogFormVisible=!1;var e=this.childTypeForm;e.categoryId=Number(e.categoryId),e.attributeNames=e.attributeNames.join(","),this.$http.get(this.$api.insertGoodsChildrenAttributeCategory,{params:e}).then(function(e){t.getTypeData()})}else if(1==this.dialogType){var a={};a.categoryId=this.childTypeForm.categoryId,a.childrenCategoryId=this.childTypeId,a.childrenName=this.childTypeForm.childrenName,a.attributeNames=this.childTypeForm.attributeNames.join(","),this.$http.get(this.$api.updateChildrenAttributeCategory,{params:a}).then(function(e){e.data.flag&&(t.$message.success("修改成功！"),t.dialogFormVisible=!1,t.getTypeData())})}},cancleChildType:function(){var t=this;this.$confirm("取消后将放弃修改，请确认是否取消？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"取消成功!"}),t.dialogFormVisible=!1}).catch(function(){t.$message({type:"info",message:"放弃 [取消] 操作!"})})},goBack:function(){this.$router.go(-1)},checkType:function(t){this.dialogType=1,this.dialogFormVisible=!0,this.childTypeForm.childrenName=t.attributeCategoryName,this.childTypeForm.attributeNames=t.childrenNames.split(","),this.childTypeId=t.attributeCategoryId},handleClose:function(t){this.childTypeForm.attributeNames.splice(this.childTypeForm.attributeNames.indexOf(t),1)},handleSizeChange:function(t){this.query.pageSize=t,this.getBrandList()},handleCurrentChange:function(t){this.query.pageNum=t,this.getBrandList()},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.subTypeInput;t&&(this.childTypeForm.attributeNames.indexOf(t)>-1?this.inputVisible=!1:this.childTypeForm.attributeNames.push(t)),setTimeout(function(){this.inputVisible=!1},300),this.subTypeInput=""}},created:function(){this.getTypeData()}}},479:function(t,e,a){var i=a(480);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(20)("32c19ca7",i,!1)},480:function(t,e,a){e=t.exports=a(7)(!1),e.push([t.i,"\n.btn-group[data-v-35512bfc],\n.search-group[data-v-35512bfc] {\n  margin-bottom: 20px;\n}\n.pagination[data-v-35512bfc] {\n  float: right;\n}\n.content .content-title[data-v-35512bfc] {\n  font-size: 18px;\n  font-family: MicrosoftYaHei-Bold;\n  color: #606266;\n  font-weight: bold;\n  margin: 0 10px 20px;\n}\n.el-tag + .el-tag[data-v-35512bfc] {\n  margin-left: 10px;\n}\n.button-new-tag[data-v-35512bfc] {\n  margin-left: 10px;\n  height: 32px;\n  line-height: 30px;\n  padding-top: 0;\n  padding-bottom: 0;\n}\n.input-new-tag[data-v-35512bfc] {\n  width: 90px;\n  margin-left: 10px;\n  vertical-align: bottom;\n}\n.attribute[data-v-35512bfc] {\n  border-radius: 4px;\n  padding: 0 10px;\n  background: #f7f7f7;\n  border: 1px solid #dcdfe6;\n  cursor: pointer;\n  margin-right: 10px;\n}\n",""])},481:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"breadcrumb"},[a("div",{staticClass:"breadcrumb-head"},[t._v("类型管理")]),t._v(" "),a("el-breadcrumb",t._l(t.$route.meta.bread,function(e,i){return a("el-breadcrumb-item",{key:i},[t._v(t._s(e))])}))],1),t._v(" "),a("div",{staticClass:"content content1 addcarousel"},[a("div",{staticClass:"content-title"},[t._v("编辑类型信息")]),t._v(" "),a("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"类型名称",prop:"categoryName"}},[a("el-input",{model:{value:t.ruleForm.attributeCategoryName,callback:function(e){t.$set(t.ruleForm,"attributeCategoryName","string"==typeof e?e.trim():e)},expression:"ruleForm.attributeCategoryName"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-button",{staticClass:"purple-bg",staticStyle:{margin:"0 28px 28px"},on:{click:t.editTypeName}},[t._v("修改类型名称")]),t._v(" "),a("el-button",{staticClass:"purple-bg",staticStyle:{margin:"0 28px 28px"},attrs:{icon:"el-icon-plus"},on:{click:t.addChildType}},[t._v("添加子类型")])],1)],1)],1),t._v(" "),a("div",{staticClass:"content content1 addcarousel"},[a("div",{staticClass:"content-title"},[t._v("子类型信息")]),t._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"tooltip-effect":"dark","default-sort":{prop:"brand",order:"descending"}}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"attributeCategoryName",label:"子类名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"childrenNames",label:"子类属性"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.goodsAttributeDto.length?a("el-button",{staticClass:"purple-txt",attrs:{type:"text",size:"small"},on:{click:function(a){t.checkType(e.row)}}},[t._v("新增")]):t._e(),t._v(" "),0!=e.row.goodsAttributeDto.length?a("el-button",{staticClass:"purple-txt",attrs:{type:"text",size:"small"},on:{click:function(a){t.editTypeAttr(e.row)}}},[t._v("修改")]):t._e(),t._v(" "),a("el-button",{staticClass:"orange-txt",attrs:{type:"text",size:"small"},on:{click:function(a){t.delChildType(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"text",disabled:""}}),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":t.query.pageNum,"page-sizes":[20,50,100,200],"page-size":t.query.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"添加子类",visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"ruleForm",attrs:{model:t.childTypeForm,rules:t.rules,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"子类名称",prop:"childrenName"}},[a("el-input",{model:{value:t.childTypeForm.childrenName,callback:function(e){t.$set(t.childTypeForm,"childrenName","string"==typeof e?e.trim():e)},expression:"childTypeForm.childrenName"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",[a("el-form-item",{attrs:{label:"子类属性",prop:"attributeNames"}},[t._l(t.childTypeForm.attributeNames,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n              "+t._s(e)+"\n            ")])}),t._v(" "),0==t.childTypeForm.attributeNames.length||t.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.handleInputConfirm(e)}},model:{value:t.subTypeInput,callback:function(e){t.subTypeInput=e},expression:"subTypeInput"}}):t._e(),t._v(" "),a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("添加")])],2)],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"purple-bg",on:{click:t.saveChildType}},[t._v("保 存")]),t._v(" "),a("el-button",{staticClass:"orange-bg",on:{click:t.cancleChildType}},[t._v("取 消")])],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"修改子类",visible:t.dialogVisible1,width:"30%"},on:{"update:visible":function(e){t.dialogVisible1=e}}},[a("el-form",{ref:"childAttr",attrs:{model:t.childAttr,rules:t.rulesOfChildAttr,"label-width":"100px"}},[a("el-row",[a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"子类名称",prop:"attributeCategoryName"}},[a("el-input",{model:{value:t.childAttr.attributeCategoryName,callback:function(e){t.$set(t.childAttr,"attributeCategoryName","string"==typeof e?e.trim():e)},expression:"childAttr.attributeCategoryName"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"子类属性",prop:"1"}},t._l(t.childAttr.goodsAttributeDto,function(e,i){return a("el-input",{key:i,staticClass:"mb10",model:{value:e.attributeName,callback:function(a){t.$set(e,"attributeName",a)},expression:"item.attributeName"}})}))],1)],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible1=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.saveChildAttr}},[t._v("确 定")])],1),t._v(" "),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.popoverVisible,callback:function(e){t.popoverVisible=e},expression:"popoverVisible"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-input",{model:{value:t.tempChildAttr,callback:function(e){t.tempChildAttr="string"==typeof e?e.trim():e},expression:"tempChildAttr"}}),t._v(" "),a("el-button",{staticClass:"mt10 purple-txt",attrs:{type:"text"},on:{click:function(e){t.popoverVisible=!1}}},[t._v("确认")]),t._v(" "),a("el-button",{staticClass:"mt10 orange-txt",attrs:{type:"text"},on:{click:function(e){t.popoverVisible=!1}}},[t._v("关闭")])],1)],1)],1)],1),t._v(" "),a("el-button",{staticClass:"purple-bg",on:{click:t.goBack}},[t._v("返回上一页")])],1)},r=[];i._withStripped=!0;var o={render:i,staticRenderFns:r};e.a=o}});