webpackJsonp([5],{"4eSe":function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.line[data-v-84b460f0] {\r\n  text-align: center;\n}\n#tmap[data-v-84b460f0] {\r\n  min-width: 600px;\r\n  min-height: 600px;\r\n  max-width: 600px;\r\n  max-height: 600px;\n}\n#tmap1[data-v-84b460f0] {\r\n  min-width: 600px;\r\n  min-height: 600px;\r\n  max-width: 600px;\r\n  max-height: 600px;\n}\n.line[data-v-84b460f0] {\r\n  text-align: center;\n}\n.max-width[data-v-84b460f0] {\r\n  max-width: 600px;\n}\n.max-height[data-v-84b460f0] {\r\n  max-height: 400px;\n}\n.appid-box[data-v-84b460f0] {\r\n  display: -webkit-box;\r\n  display: -ms-flexbox;\r\n  display: flex;\n}\n.appid-close[data-v-84b460f0] {\r\n  position: absolute;\r\n  width: 20px;\r\n  height: 20px;\r\n  top: 50%;\r\n  right: 5px;\r\n  /* background: #999; */\r\n  text-align: center;\r\n  line-height: 20px;\r\n  border-radius: 50%;\r\n  color: #fff;\r\n  -webkit-transform: translateY(-50%);\r\n          transform: translateY(-50%);\r\n  font-size: 18px;\n}\n.appid[data-v-84b460f0] {\r\n  width: 200px;\r\n  position: relative;\r\n  /* border:1px solid #cccccc; */\r\n  background: rgb(233, 231, 231);\r\n  border-radius: 4px;\r\n  margin: 0 10px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  padding: 0 5px;\r\n  cursor: pointer;\n}\r\n",""])},AJqP:function(e,t,a){var o=a("4eSe");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("072c3c4a",o,!1)},M2JT:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),l=a.n(o),n=a("tnjw"),r=a("TIfe"),s=null,i={data:function(){return{qrcode:null,qrFlag:!1,boxFlag:"0",orderNo:null,select:{province:"",city:"",area:""},newAppidVal:null,newAppidIdx:null,inputFlag:0,form:{addressType:"1",resourceType:"2",lat:null,lng:null,adId:"",distance:"",totalNum:"",touchTimes:"",boxNum:"",boxAmount:"",compition:"",province:"",city:"",district:"",address:""},dialogImageUrl:"",dialogVisible:!1,optionsOfAd:[{value:"1",label:"小程序"},{value:"2",label:"唯柚店铺"},{value:"3",label:"导航"}],optionsOfAdd:[{value:"1",label:"区域"},{value:"2",label:"距离"}],optionsOfBox:[{value:"0",label:"不发宝箱"},{value:"1",label:"发宝箱"}],value:"3",options1:[{value:"1",label:"小程序111"},{value:"2",label:"小程序222"},{value:"3",label:"小程序333"}],value1:"1",optionsOfDistance:[{value:"10000",label:"10km"},{value:"20000",label:"20km"},{value:"50000",label:"50km"},{value:"100000",label:"100km"},{value:"-1",label:"全国"}],address:"",value2:"10"}},watch:{"form.resourceType":function(e){},newAppidVal:function(e){console.log("wacth newAppidVal"),console.log(e),e||(this.inputFlag=0)}},created:function(){var e=Object(r.c)();this.form.lat=23.09815304639614,this.form.lng=113.34259450435638,e.lat&&(this.form.lat=e.lat,this.form.lng=e.lng),this.l2a(this.form.lat,this.form.lng)},mounted:function(){this.initMap()},methods:{initMap:function(){var e=this,t=this;Object(n.a)("LESBZ-MWHWP-2ARD5-VS75Q-U4UB3-6QBLV").then(function(a){var o=new a.maps.LatLng(Number(e.form.lat),Number(e.form.lng));console.log(o);var l=new a.maps.Map(document.getElementById("tmap"),{center:o,zoom:11}),n=new a.maps.Marker({position:o,map:l});n.setVisible(!0),n.setDraggable(!0),a.maps.event.addListener(n,"dragend",function(){console.log(n.getPosition()),o=n.getPosition()}),a.maps.event.addListener(l,"click",function(e){console.log("您点击了地图。位置为==="),console.log("["+e.latLng.getLng()+","+e.latLng.getLat()+"]");var l=e.latLng.getLng(),r=e.latLng.getLat();t.form.lat=r,t.form.lng=l,t.l2a(r,l),o=new a.maps.LatLng(r,l),console.log(o),n.setPosition(o)})})},l2a:function(e,t){var a=this,o={lat:e,lng:t};this.$ajax.get(this.$api.l2a,{params:o}).then(function(e){console.log("经纬度转地理位置"),console.log(e);var t=e.data.result;a.address=t.address})},onSelected:function(e){console.log(e)},onProvince:function(e){console.log(e.value),this.form.province=e.value,this.form.lat="",this.form.lng=""},onCity:function(e){console.log(e.value),this.form.city=e.value},onArea:function(e){console.log(e.value),this.form.district=e.value},chooseItem:function(e){console.log("chooseItem");var t=e.target.dataset.idx,a=e.target.dataset.val;console.log("idx="+t+"   val="+a),this.newAppidVal=a,this.newAppidIdx=t,this.inputFlag=1,console.log("inputFlag=="+this.inputFlag)},addItem:function(e){console.log("addItem");var t=this.newAppidVal,a=this.form.appid,o=a;o.push({val:t}),a=[],this.form.appid=o,this.newAppidVal=null},editItem:function(e){console.log("editItem");var t,a=this.newAppidIdx,o=this.newAppidVal,l=this.form.appid;l[a].val=o,t=l,this.form.appid=t,this.newAppidVal=null},closeItem:function(e){console.log("closeItem");var t=e.target.dataset.idx,a=e.target.dataset.val;console.log("idx="+t+"   val="+a);var o=[];this.form.appid.forEach(function(e,a){a!=t&&o.push(e)}),console.log(o),this.form.appid=o},mapClick:function(){null.maps.event.addListener(map,"click",function(){console.log("您点击了地图。")}),console.log("地图点击事件")},onSubmit:function(){var e=this;console.log("submit!");var t=JSON.parse(l()(this.form));console.log("form"),console.log(t);var a={};a.resourceType=t.resourceType,a.addressType=t.addressType,a.totalAmount=t.totalAmount,a.touchTimes=t.touchTimes,console.log(a),1==t.resourceType?a.adId=t.adId:2==t.resourceType||t.resourceType,1==t.addressType?(t.province&&(a.province=t.province),t.city&&(a.city=t.city),t.district&&(a.district=t.district)):2==t.addressType&&(a.lat=t.lat,a.lng=t.lng,a.distance=t.distance),1==this.boxFlag&&(a.boxNum=t.boxNum,a.boxAmount=t.boxAmount),console.log("params"),console.log(a),a=l()(a),this.$ajax.post(this.$api.createMerchantAdOrder,a).then(function(t){console.log("新增广告"),console.log(t);var a=t.data.data;t.flag&&(console.log("新增广告 flag= true"),e.qrcode=a.payData.codeUrl,e.qrFlag=!0,e.orderNo=a.orderData.orderNo,s=setInterval(e.checkPayStatus,1e3))})},checkPayStatus:function(){console.log("检测支付状态");var e=this,t={orderNo:e.orderNo};e.$ajax.post(e.$api.checkOrderPaymentStatus,t).then(function(t){t.flag&&(clearInterval(s),e.$message.success("支付成功，2秒后返回广告列表"),e.qrFlag=!1,setTimeout(function(){e.$router.go(-1)},2e3))})},onCancel:function(){this.$message({message:"cancel!",type:"warning"})},handleRemove:function(e,t){console.log(e,t)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0}}},c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container content"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"广告类型"}},[a("el-select",{attrs:{placeholder:"广告类型"},model:{value:e.form.resourceType,callback:function(t){e.$set(e.form,"resourceType",t)},expression:"form.resourceType"}},e._l(e.optionsOfAd,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.form.resourceType,expression:"form.resourceType==1"}],attrs:{label:"appId"}},[a("el-input",{staticClass:"max-width",model:{value:e.form.adId,callback:function(t){e.$set(e.form,"adId",t)},expression:"form.adId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"地址类型"}},[a("el-select",{attrs:{placeholder:"地址类型"},model:{value:e.form.addressType,callback:function(t){e.$set(e.form,"addressType",t)},expression:"form.addressType"}},e._l(e.optionsOfAdd,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.form.addressType,expression:"form.addressType==1"}],attrs:{label:"选择区域"}},[a("div",{staticClass:"flex"},[a("v-distpicker",{attrs:{province:e.select.province,city:e.select.city,area:e.select.area},on:{selected:e.onSelected,province:e.onProvince,city:e.onCity,area:e.onArea}})],1)]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.form.addressType,expression:"form.addressType==2"}],attrs:{label:"选择距离"}},[a("el-select",{attrs:{placeholder:"选择距离"},model:{value:e.form.distance,callback:function(t){e.$set(e.form,"distance",t)},expression:"form.distance"}},e._l(e.optionsOfDistance,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.form.addressType&&-1!=e.form.distance,expression:"form.addressType==2&&form.distance!=-1"}],attrs:{label:"详细地址"}},[e._v("\n      "+e._s(e.address)+"\n    ")]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.form.addressType&&-1!=e.form.distance,expression:"form.addressType==2&&form.distance!=-1"}],attrs:{label:"发布位置"}},[a("div",{attrs:{id:"tmap"}})]),e._v(" "),a("el-form-item",{attrs:{label:"红包金额"}},[a("el-input",{staticClass:"max-width",model:{value:e.form.totalAmount,callback:function(t){e.$set(e.form,"totalAmount",t)},expression:"form.totalAmount"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"触达人数"}},[a("el-input",{staticClass:"max-width",model:{value:e.form.touchTimes,callback:function(t){e.$set(e.form,"touchTimes",t)},expression:"form.touchTimes"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"宝箱选项"}},[a("el-select",{attrs:{placeholder:"宝箱选项"},model:{value:e.boxFlag,callback:function(t){e.boxFlag=t},expression:"boxFlag"}},e._l(e.optionsOfBox,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.boxFlag,expression:"boxFlag==1"}],attrs:{label:"宝箱数量"}},[a("el-input",{staticClass:"max-width",model:{value:e.form.boxNum,callback:function(t){e.$set(e.form,"boxNum",t)},expression:"form.boxNum"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.boxFlag,expression:"boxFlag==1"}],attrs:{label:"单个宝箱金额"}},[a("el-input",{staticClass:"max-width",model:{value:e.form.boxAmount,callback:function(t){e.$set(e.form,"boxAmount",t)},expression:"form.boxAmount"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")]),e._v(" "),a("el-button",{on:{click:e.onCancel}},[e._v("取消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"请用微信扫描二维码支付",visible:e.qrFlag,width:"30%"},on:{"update:visible":function(t){e.qrFlag=t}}},[a("div",{staticClass:"flex flex-center"},[a("img",{attrs:{src:e.qrcode,alt:"#"}})]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.qrFlag=!1}}},[e._v("确 定")])],1)]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:Boolean(e.qrcode),expression:"Boolean(qrcode)"}],attrs:{type:"primary"},on:{click:function(t){e.qrFlag=!0}}},[e._v("查看二维码")])],1)};c._withStripped=!0;var d={render:c,staticRenderFns:[]},m=d;var p=!1;var u=a("VU/8")(i,m,!1,function(e){p||a("AJqP")},"data-v-84b460f0",null);u.options.__file="src\\views\\redpacket\\Give.vue";t.default=u.exports}});